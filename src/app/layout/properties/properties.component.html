
<div class="container-fluid">
      <div class="row">
         <div class="col-md-4">
               <div class="form-group">
                  <p class="p16">Manage Properties</p>
               </div>
         </div>
      </div>
      <div class="row">
         <div class="offset-md-4"></div>
         <div class="col-md-8 col-12">
               <div class="cust-tabs-2">
                  <ul class="nav nav-tabs float-right">
                     <li class="nav-item">
                        <a [ngClass]="{'active':parameter.dash_flag == 1}" (click)="changeFlag(1)" class="nav-link" data-toggle="tab" href="#tw">This Week</a>
                     </li>
                     <li class="nav-item">
                        <a [ngClass]="{'active':parameter.dash_flag == 2}" (click)="changeFlag(2)" class="nav-link" data-toggle="tab" href="#tm">This Month</a>
                     </li>
                     <li class="nav-item">
                        <a [ngClass]="{'active':parameter.dash_flag == 3}" (click)="changeFlag(3)" class="nav-link" data-toggle="tab" href="#lm">Last Month</a>
                     </li>
                     <li class="nav-item">
                        <a [ngClass]="{'active':parameter.dash_flag == 4}" (click)="changeFlag(4)" class="nav-link" data-toggle="tab" href="#lt">Lifetime</a>
                     </li>
                     <li class="nav-item">
                        <a [ngClass]="{'active':parameter.dash_flag == 5}" (click)="changeFlag(5)" class="nav-link" data-toggle="tab" href="#cust">Custom</a>
                     </li>
                  </ul>
               </div>
         </div>
      </div>
   
      <div class="row">
      <div class="col-12">
            <div *ngIf="parameter.dash_flag == 5" class="row">
               <div class="offset-lg-7"></div>
               <div class="col-lg-2 col-md-2 col-sm-5 col-5">
               <div class="form-group marginB0">
                  <label>From:</label>
                  <p-calendar showIcon="true" [(ngModel)]="parameter.min" [maxDate]="today" showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"></p-calendar>
               </div>
               </div>
               <div class="col-lg-2 col-md-2 col-sm-5 col-5">
               <div class="form-group marginB0">
                  <label>To:</label>
                  <p-calendar showIcon="true" [(ngModel)]="parameter.max" [minDate]="parameter.min" [maxDate]="today" showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"></p-calendar>
               </div>
               </div>
               <div class="col-lg-1 col-md-2 col-sm-2 col-6">
               <div class="form-group btn-cont">
                  <label class="addMT3">&nbsp;</label>
                  <button class="btn btn-calender" href="javascript://" (click)="getListing()"
                        [disabled]="!parameter.min || !parameter.max">Apply</button>
               </div>
               </div>
            </div>
      </div>
   </div>

   <div class="row">
      <div class="col-lg-2 col-md-2">
            <div class="form-group">
            <label>Country</label>
            <select class="form-control" (change)="onCountryChange($event.target.value)">
               <option value="0">All</option>
               <option *ngFor="let item of location.countries" [value]="item.id">{{item.name}}</option>
            </select>
            </div>
      </div>
      <div class="col-lg-2 col-md-2">
            <div class="form-group">
            <label>State</label>
            <select class="form-control" (change)="onStateChange($event.target.value)">
               <option value="0">All</option>
               <option *ngFor="let item of location.states" [value]="item.id">{{item.name}}</option>
            </select>
            </div>
      </div>
      <div class="col-lg-2 col-md-2">
            <div class="form-group">
            <label>City</label>
               <select class="form-control" (change)="onCityChange($event.target.value)">
               <option value="0">All</option>
               <option *ngFor="let item of location.cities" [value]="item.id">{{item.name}}</option>
               </select>
            </div>
      </div>

      <div class="col-lg-2 col-md-2">
            <div class="form-group">
            <label>Locality</label>
            <select class="form-control" (change)="getLocalityBuildings($event.target.value)">
               <option value="0">All</option>
               <option *ngFor="let item of location.localities" [value]="item.id">{{item.name}}</option>
            </select>
            </div>
      </div>

      <div class="col-lg-2 col-md-2">
         <div class="form-group marginB0">
               <label>Building</label>
               <select class="form-control" (change)="setBuilding($event.target.value)">
               <option value="0">All</option>
               <option *ngFor="let building of parameter.buildings" value="{{building.id}}">{{building.name}}</option>
               </select>
         </div>
      </div>
      
      <div class="col-lg-1 col-md-2">
            <div class="form-group btn-cont">
            <label style="display: block; margin-top: 3px;">&nbsp;</label>
            <button type="button" (click)="getListing()" class="btn btn-primary-new width100P P86">Apply</button>
            </div>
      </div>

      <div class="col-lg-1 col-md-2">
            <div class="form-group btn-cont">
            <label style="display: block; margin-top: 3px;">&nbsp;</label>
            <button type="button" (click)="resetFilters()" class="btn btn-primary-new width100P P86">Reset</button>
            </div>
      </div>
   </div>
   <!-- <div class="row">
      <div class="col-md-4">
      <div class="form-group">
         <p class="p16">Manage Properties</p>
         </div>
      </div>
      <div class="col-md-2">
   <div class="form-group">
   <label>Country</label>
      <select class="form-control" (change)="onCountryChange($event.target.value)">
         <option value="0">All</option>
         <option *ngFor="let item of location.countries" [value]="item.id">{{item.name}}</option>
      </select>
   </div>
   </div>
   <div class="col-md-2">
   <div class="form-group">
   <label>State</label>
      <select class="form-control" (change)="onStateChange($event.target.value)">
         <option value="0">All</option>
         <option *ngFor="let item of location.states" [value]="item.id">{{item.name}}</option>
      </select>
   </div>
   </div>
   <div class="col-md-2">
      <div class="form-group">
      <label>City</label>
         <select class="form-control" (change)="onCityChange($event.target.value)">
         <option value="0">All</option>
         <option *ngFor="let item of location.cities" [value]="item.id">{{item.name}}</option>
         </select>
      </div>
   </div>

   <div class="col-md-2">
   <div class="form-group">
   <label>Locality</label>
   <select class="form-control" (change)="onLocalityChange($event.target.value)">
         <option value="0">All</option>
         <option *ngFor="let item of location.localities" [value]="item.id">{{item.name}}</option>
      </select>
   </div>
   </div>
   </div>

   <div class="row">
         <div class="col-md-12">
            <div class="cust-tabs-2">
               <ul class="nav nav-tabs float-right">
                  <li class="nav-item">
                     <a [ngClass]="{'active':parameter.dash_flag == 1}" (click)="parameter.dash_flag=1;getListing()" class="nav-link" data-toggle="tab" href="#tw">This Week</a>
                  </li>
                  <li class="nav-item">
                     <a [ngClass]="{'active':parameter.dash_flag == 2}" (click)="parameter.dash_flag=2;getListing()" class="nav-link" data-toggle="tab" href="#tm">This Month</a>
                  </li>
                  <li class="nav-item">
                     <a [ngClass]="{'active':parameter.dash_flag == 3}" (click)="parameter.dash_flag=3;getListing()" class="nav-link" data-toggle="tab" href="#lm">Last Month</a>
                  </li>
                  <li class="nav-item">
                     <a [ngClass]="{'active':parameter.dash_flag == 4}" (click)="parameter.dash_flag=4;getListing()" class="nav-link" data-toggle="tab" href="#lt">Lifetime</a>
                  </li>
                  <li class="nav-item">
                     <a [ngClass]="{'active':parameter.dash_flag == 5}" (click)="parameter.dash_flag=5" class="nav-link" data-toggle="tab" href="#cust">Custom</a>
                  </li>
               </ul>
            </div>
         </div>
         <div class="col-12">
            <div *ngIf="parameter.dash_flag == 5" class="pull-right row">
               <div class="col-lg-4 col-md-4 col-sm-5 col-5">
               <div class="form-group marginB0">
                     <label>From:</label>
                     <p-calendar showIcon="true" [(ngModel)]="parameter.min" [maxDate]="today" showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"></p-calendar>
               </div>
               </div>
               <div class="col-lg-4 col-md-4 col-sm-5 col-5">
               <div class="form-group marginB0">
                     <label>To:</label>
                     <p-calendar showIcon="true" [(ngModel)]="parameter.max" [minDate]="parameter.min" [maxDate]="today" showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"></p-calendar>
               </div>
               </div>
               <div class="col-lg-4 col-md-4 col-sm-2 col-6">
               <div class="form-group btn-cont">
                     <label class="addMT3">&nbsp;</label>
                     <button class="btn btn-calender" href="javascript://" (click)="getListing()"
               [disabled]="!parameter.min || !parameter.max">Apply</button>
               </div>
               </div>
            </div>
         </div>
      </div> -->

         <div class="cust-tabs">
         <div class="row flex-wrap-reverse">
            
            <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 col-12">
            <ul class="nav nav-tabs">
               <li class="nav-item">
                  <a [ngClass]="{'active':parameter.flag==3}" (click)="changePropertyFlag(3)" class="nav-link" >Approved</a>
               </li>
               <li class="nav-item">
                  <a [ngClass]="{'active':parameter.flag==4}" (click)="changePropertyFlag(4)" class="nav-link" >Unapproved</a>
               </li>
               <li class="nav-item">
                  <a [ngClass]="{'active':parameter.flag==2}" (click)="changePropertyFlag(2)" class="nav-link" >Pending Review</a>
               </li>
               <li class="nav-item">
                  <a [ngClass]="{'active':parameter.flag==1}" (click)="changePropertyFlag(1)" class="nav-link" >In Draft</a>
               </li>
               <li class="nav-item">
                  <a [ngClass]="{'active':parameter.flag==5}" (click)="changePropertyFlag(5)" class="nav-link" >Seller's Request</a>
               </li>
            </ul>
            </div>
            <div class="col-xl-2 col-lg-12 col-md-12 col-sm-12 col-12">
               <div class="add-new text-left">
                  <a *ngIf="admin?.admin_acl['Property Management']?.can_create==1" class="btn" href="javascript://" routerLink="/dashboard/properties/add-bulk-property/0/0">+Add Bulk Property</a>
               </div>
            </div>
            <div class="col-xl-2 col-lg-12 col-md-12 col-sm-12 col-12">
               <div class="add-new text-left">
                  <a *ngIf="admin?.admin_acl['Property Management']?.can_create==1" class="btn" href="javascript://" routerLink="/dashboard/properties/add-property/0/0">+Add New Property</a>
               </div>
            </div>
         </div>
         <div class="tab-content white-bg">
            <div class="tab-pane active">
               <div class="tabel-section">
                  <div class="table-responsive">
                     <table class="table table-striped table-align-left">
                        <tr>
                           <th style="width:10%; text-align:left;">
                              <div class="table-search">
                                 <label>Name of Building</label>
                                 <div class="searh-3">
                                    <input type="text" [(ngModel)]="parameter.keyword" (keyup.enter)="getListing()" >
                                    <button *ngIf="parameter.keyword" (click)="getListing()"><i class="fa fa-search"></i></button>
                                 </div>
                              </div>
                           </th>
                           <th style="width:10%; text-align:left;">
                              <div class="table-search">
                                 <label>Name of Tower</label>
                                 <div class="searh-3">
                                    <input type="text" [(ngModel)]="parameter.tower_name" (keyup.enter)="getListing()" >
                                    <button *ngIf="parameter.tower_name" (click)="getListing()"><i class="fa fa-search"></i></button>
                                 </div>
                              </div>
                           </th>
                           <th style="width:10%; text-align:left;">
                              <div class="table-search">
                                 <label>Name of Apartment</label>
                                 <div class="searh-3">
                                    <input type="text" [(ngModel)]="parameter.name" (keyup.enter)="getListing()" >
                                    <button *ngIf="parameter.name" (click)="getListing()"><i class="fa fa-search"></i></button>
                                 </div>
                              </div>
                           </th>
                           <th style="width:10%; text-align:left;">
                              <div class="table-search">
                                 <label>Configuration</label>
                                 <select [(ngModel)]="parameter.configuration_id" (change)="getListing()">
                                    <option value="0">All</option>
                                    <option *ngFor="let c of configurations" value="{{c.id}}" >
                                       <!-- {{c.name}} -->
                                       <span *ngIf="c.status">
                                          <span *ngIf="c.bedroom!=0">{{c.bedroom}} Bed </span>
                                          <span *ngIf="c.bathroom!=0">&middot; {{c.bathroom}} Bath </span>
                                          <span *ngIf="c.half_bathroom!=0">&middot; {{c.half_bathroom}} Half Bath </span>
                                       </span>
                                    </option>
                                 </select>
                              </div>
                           </th>
                           <th style="width:8%;vertical-align:top;">
                              <div (click)="sort_by(1)" class="d-flex table-search">
                                 <label>Price</label>
                                 <a href="javascript://"><img [ngClass]="{'upsidedown':parameter.sort_by==1 && parameter.sort_by_order==0}" src="assets/img/top-arrow.png" alt="img"></a></div>
                           </th>
                           <th style="width:4%;vertical-align:top;">
                              <div class="d-flex table-search">
                                 <label>Edit <br> Price</label>
                              </div>
                           </th>
                           <th style="width:4%;vertical-align:top;">
                              <div (click)="sort_by(3)" class="d-flex table-search">
                                 <label>Leads</label>
                                 <a href="javascript://"><img [ngClass]="{'upsidedown':parameter.sort_by==3 && parameter.sort_by_order==0}" src="assets/img/top-arrow.png" alt="img"></a>
                              </div>
                           </th>
                           <th style="width:5%;vertical-align:top;" *ngIf="parameter.flag==5">
                              <div class="d-flex table-search">
                                 <label>View Seller's <br> Request</label>
                              </div>
                           </th>
                           <th *ngIf="parameter.flag!=5" style="width:5%;vertical-align:top;">
                              <div class="d-flex table-search">
                                 <label>Change <br> Seller</label>
                              </div>
                           </th>
                           <th *ngIf="parameter.flag!=5" style="width:6%;vertical-align:top;">
                              <div class="d-flex table-search">
                                 <label>Link / <br>Unlink<br>Agent</label>
                              </div>
                           </th>
                           <th *ngIf="parameter.flag!=5" style="width:10%;vertical-align:top;">
                              <div (click)="sort_by(2)" class="d-flex table-search">
                                 <label>Change <br> Availability</label>
                              </div>
                           </th>
                           <th *ngIf="parameter.flag!=5" style="width:5%;vertical-align:top;">
                              <div class="d-flex table-search">
                                 <label>Is Property <br> Sold</label>
                              </div>
                           </th>
                           <th style="width:15%;" *ngIf="parameter.flag!=5">&nbsp;</th>
                        </tr>
                  
                        <tr *ngFor="let p of items | paginate: { itemsPerPage: parameter.itemsPerPage, currentPage: parameter.page, totalItems: total }; let i=index">
                              <td class="cursor-pointer" title="Click to view details" (click)="viewPropertyDetails(p.id, p)">
                                    <!-- routerLink="/dashboard/properties/details/{{p.id}}" -->
                                 <strong>{{p?.building?.name?p?.building?.name:'NA'}}</strong>
                                 <div class="clearfix"></div>
                                 <small *ngIf="p.quantity > 0">
                                    {{p.quantity}} 
                                    <span *ngIf="p.quantity == 1">property</span>
                                    <span *ngIf="p.quantity > 1">properties</span>
                                 </small>
                              </td>
                              <td><span>{{p?.building_towers ? p?.building_towers?.tower_name : 'NA'}}</span></td>
                              <td><span>{{p?.name ? p?.name : 'NA'}}</span></td>
                              <td>
                                 <!-- <span *ngIf="p && p.configuration">{{p.configuration?.name}}</span> -->
                                 <span *ngIf="p.configuration.bedroom!=0">{{p.configuration.bedroom}} Bed </span>
                                 <span *ngIf="p.configuration.bathroom!=0">&middot; {{p.configuration.bathroom}} Bath </span>
                                 <span *ngIf="p.configuration.half_bathroom!=0">&middot; {{p.configuration.half_bathroom}} Half Bath </span>
                              </td>
                              <td><span>{{p.min_price | price}}</span></td>
                              <!-- <td><span>{{p.min_price | number : '1.2-2'}}</span></td> -->
                              <td><span>
                                 <button (click)="editPricePopup(p, i)" [disabled]="admin?.admin_acl['Property Management']?.can_update==0" title="Edit Price" class="action-icon"><img src="assets/img/edit.png" alt="img"></button>
                              </span></td>
                              <td><span>{{p.lead_properties_count | numberWithCommas}}</span></td>
                              
                              <td *ngIf="parameter.flag==5" class="cursor-pointer" title="View Seller's Request" (click)="showAllSellers(p?.id, i)">
                                 <span class="green-color"><span>View</span></span>
                              </td>
                              
                              <td *ngIf="parameter.flag!=5" class="cursor-pointer" title="{{p?.selected_seller?.user?.name ? 'Click to change Seller' : 'Click to add Seller'}}" (click)="getAllSellers(p, '1', i)">
                                 <span class="green-color"><span>
                                       {{p?.selected_seller?.user?.name ? p?.selected_seller?.user?.name : 'Add'}}
                                 </span></span>
                              </td>
                              
                              <td *ngIf="parameter.flag!=5" class="cursor-pointer" (click)="getBothBroker(p, '')">
                                 <span class="green-color">
                                    <span title="Click to {{p?.external_broker?.id ? 'change' : 'assign'}}">{{p?.external_broker?.id ? 'Change' : 'Link'}}</span>
                                 </span>
                              </td>
                              <td *ngIf="parameter.flag!=5" class="cursor-pointer" >
                                 <select id="avaStatus" #avaStatus  (change)="avaStatus.value == changeSoldStatusPopup(p, i, $event.target.value)">
                                    <option [selected]="p.for_sale==1" value="1">Sell</option>
                                    <option [selected]="p.for_rent==1" value="2">Rent</option>
                                    <option [selected]="p.for_hold==1" value="3">Inventory</option>
                                 </select>
                              </td>
                              <td *ngIf="parameter.flag!=5">
                                 {{p?.is_property_sold ? 'Yes' : 'No'}}
                              </td>
                              <td *ngIf="parameter.flag!=5">
                              <div class="table-actions">
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="parameter?.flag!=3" routerLink="../edit-property/{{p.id}}" title="Edit Details" class="action-icon"><img src="assets/img/edit.png" alt="img"></button>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="parameter?.flag==3" routerLink="../edit-property/{{p.id}}/edit" title="Edit Details" class="action-icon"><img src="assets/img/edit.png" alt="img"></button>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_delete==0" *ngIf="!p.is_blocked" (click)="blockUnblock(p, 1);" class="action-icon" title="Block"><img src="assets/img/block.png" alt="img"></button>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_delete==0" *ngIf="p.is_blocked == true" (click)="blockUnblock(p, 0);" class="action-icon unblock-bg" title="UnBlock"><img src="assets/img/unblock.png" alt="img"></button>
                                 
                                 <!-- unapprove -->
                                 <a style="display:none;" #modalOpen data-toggle="modal" data-target="#addPropertyReason"></a>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="p.status == 3" (click)="openCancellationModal(p, 4);" class="action-icon" title="Unapprove"><img src="assets/img/ic_disapprove.png" alt="img"></button>

                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="p.status == 2" (click)="changeStatus(p,3);" class="action-icon" title="Approve"><img src="assets/img/tick.png" alt="img"></button>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="p.status == 3 && p.is_featured==0" (click)="markPropertyFeatured(p,1);" class="action-icon" title="Mark feature"><img src="assets/img/ic_featured.png" alt="img"></button>
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_update==0" *ngIf="p.status == 3 && p.is_featured==1" (click)="markPropertyFeatured(p,0);" class="action-icon" title="Mark unfeature"><img src="assets/img/tick-selected.png" alt="img"></button>
                                 <!-- delete -->
                                 <button [disabled]="admin?.admin_acl['Property Management']?.can_purge==0" (click)="deletePopup(p, i)" class="action-icon" 
                                    title="Delete Property"><img src="assets/img/ic_delete.png" alt="img"></button>
                              </div>

                              </td>
                        </tr>
                        <!-- <tr *ngIf="parameter.loading == false && total == 0">
                           <td colspan="10">No result found</td>
                           </tr> -->
                     </table>
                     <div class="padding20 center" *ngIf="parameter.loading == false && total == 0">
                           <img src="assets/img/404-error.png">
                     </div>
                  </div>
               </div>
            </div>
            <div class="tab-pane container fade" id="seller">Seller tab on</div>
         </div>
      </div>
      
    <div class="btn-cont marginT15" *ngIf="total">
         <div class="row">
             <div class="col-6">
                 <div class="title-group">
                     <p>Showing {{items?.length}} out of {{total}}</p>
                 </div>
             </div>
             <div class="col-6 text-right">
                 <pagination-controls class="my-pagination" (pageChange)="getPage($event)"></pagination-controls>
             </div>
         </div>
     </div>
</div>




<!-- All Sellers -->
<a data-toggle="modal" data-target="#link-user-model" #linkUserModal></a>
<div class="modal" id="link-user-model">
   <div class="modal-dialog ">
      <div class="modal-content notary-avail">
            <div class="modal-header popup-header">
            <h4 class="modal-title">Link/Unlink Seller</h4>
            <button type="button" class="close" #closeLinkUserModal data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

               <p class="modal-title marginB20" *ngIf="selecter_seller">Currently linked to Seller - <b>{{selecter_seller?.user?.name}}</b></p>

               <div class="row">
                  <div class="col-md-8 col-6">
                     <input style="max-width:200px" (keyup.enter)="getAllSellers('', keyword, '')" [(ngModel)]="keyword" class="form-control" type="text" name="keyword" placeholder="Search">
                 </div>
                 <div class="col-md-4 col-5 btn-cont">
                     <a class="btn btn-primary pull-right" href="javascript://" (click)="getAllSellers('', keyword, '')">Search</a>
                 </div>
               </div>

               <div class="spacer40"></div>
               <div class="modal-table-data" malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                  <table class="table">
                     <tr *ngFor="let item of allUsers">
                        <td>
                           <div class="n-avail-profile">
                           <img *ngIf="item?.image" onerror='src="assets/img/default_img.png"' alt="img"
                              [defaultImage]="item?.image| img:'thumb'" [lazyLoad]="item?.image">
                           <img *ngIf="!item?.image" src="assets/img/default_img.png" alt="img">
                           
                           <div class="n-avail-info">
                              <p class="p12">{{item?.name}}</p>
                              <p class="p10 marginB0">Phone : {{item?.dial_code ? item?.dial_code : constant.dial_code}}-{{item?.phone}}</p>
                              <p class="p10">{{item?.is_developer==1 ? 'Developer' : 'Seller'}}</p>
                           </div>
                           </div>
                        </td>
                        <td>
                           <button *ngIf="parameter.seller_id!=item.id" (click)="changeStatusPopUp(parameter.property_id, item.id, item.name, 1, 'link')" class="action-icon" title="Accept Request">
                              <img src="assets/img/green-icon.png" alt="img"></button>
                           <button *ngIf="parameter.seller_id==item.id" (click)="showRejectSellerRequestModal(parameter.property_id, item.id, 2)" class="action-icon" title="Reject Request">
                                 <img src="assets/img/ic_disapprove.png" alt="img"></button>
                        </td>
                     </tr>
                     <tr *ngIf="allUsers?.length==0">
                        <p class="show-not-found">
                           No seller found.
                        </p>
                     </tr>
                  </table>
               </div>
            </div>
      </div>
   </div>
</div>


<!-- Link Seller -->
<a data-toggle="modal" data-target="#link-seller-model" #linkSellerModal></a>
<div class="modal" id="link-seller-model">
   <div class="modal-dialog ">
      <div class="modal-content notary-avail">
            <div class="modal-header popup-header">
            <h4 class="modal-title">Requests</h4>
            <button type="button" class="close" #closeLinkSellerModal data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

               <p class="modal-title" *ngIf="selecter_seller">Currently linked to Seller - <b>{{selecter_seller?.user?.name}}</b></p>

               <!-- <div class="row">
                     <input style="max-width:200px" [(ngModel)]="keyword" (input)="showAllSellers()" class="form-control" type="text" name="keyword" placeholder="Search">
               </div> -->
               <div class="spacer40"></div>
               <div class="modal-table-data" malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                  <table class="table">
                     <tr *ngFor="let item of allSellers">
                        <td *ngIf="item?.user && item?.user?.is_blocked!=1">
                           <div class="n-avail-profile">
                           <img *ngIf="item?.user?.image" onerror='src="assets/img/default_img.png"' alt="img"
                              [defaultImage]="item?.user?.image| img:'thumb'" [lazyLoad]="item?.user?.image">
                           <img *ngIf="!item?.user?.image" src="assets/img/default_img.png" alt="img">
                           
                           <div class="n-avail-info">
                              <p class="p12">{{item?.user?.name ? item?.user?.name : 'NA'}}</p>
                              <p class="p10">Phone : {{item?.user?.dial_code ? item?.user?.dial_code : constant.dial_code}}-{{item?.user?.phone}}</p>
                           </div>
                           </div>
                        </td>
                        <td *ngIf="item?.user && item?.user?.is_blocked!=1">
                           <button (click)="changeStatusPopUp(item.property_id, item.user_id, item.user.name, 1, 'request')" class="action-icon" title="Accept Request">
                              <img src="assets/img/green-icon.png" alt="img"></button>
                           <button (click)="showRejectSellerRequestModal(item.property_id, item.user_id, 2)" class="action-icon" title="Reject Request">
                                 <img src="assets/img/ic_disapprove.png" alt="img"></button>
                        </td>
                     </tr>
                     <tr *ngIf="allSellers?.length==0">
                        <p class="show-not-found">
                           No seller has requested for the property.
                        </p>
                     </tr>
                  </table>
               </div>
            </div>
      </div>
   </div>
</div>

<!-- Link External Broker -->
<a data-toggle="modal" data-target="#link-broker-model" #linkExtBrokerModal></a>
<div class="modal" id="link-broker-model">
   <div class="modal-dialog ">
      <div class="modal-content notary-avail">
            <div class="modal-header popup-header">
            <h4 class="modal-title">{{property?.external_broker?.id ? 'Change' : 'Link'}} Agent</h4>
            <button type="button" class="close" #closeExtBrokerModal data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

               <p class="modal-title" *ngIf="property?.external_broker?.id">Currently linked to Agent - <b>{{property?.external_broker?.name}}</b></p>

               <div class="row">
                  <div class="col-md-8 col-6">
                     <input style="max-width:200px" (keyup.enter)="getBothBroker('', keyword)" [(ngModel)]="keyword" class="form-control" type="text" name="keyword" placeholder="Search">
                 </div>
                 <div class="col-md-4 col-5 btn-cont">
                     <a class="btn btn-primary pull-right" href="javascript://" (click)="getBothBroker('', keyword)">Search</a>
                 </div>
               </div>

               <div class="spacer40"></div>
               <div class="modal-table-data" malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                  <table class="table">
                     <tr *ngFor="let item of allExtBrokers">
                        <td>
                           <div class="n-avail-profile">
                           <img *ngIf="item?.image" onerror='src="assets/img/default_img.png"' alt="img"
                              [defaultImage]="item?.image| img:'thumb'" [lazyLoad]="item?.image">
                           <img *ngIf="!item?.image" src="assets/img/default_img.png" alt="img">
                           
                           <div class="n-avail-info">
                              <p class="p12">{{item?.name | titlecase}}</p>
                              <p class="p10 marginB0">{{item?.is_external_agent ? 'OUTSIDE AGENT' : 'IN-HOUSE AGENT'}}</p>
                              <p class="p10">Phone : {{item?.dial_code ? item?.dial_code : constant.dial_code}}-{{item?.phone}}</p>
                           </div>
                           </div>
                        </td>
                        <td>
                           <button *ngIf="property?.external_broker?.id!=item.id" (click)="attachExternalBrokerPopUp(item, 1)" class="action-icon" title="Link agent">
                              <img src="assets/img/green-icon.png" alt="img"></button>
                           
                           <button *ngIf="property?.external_broker?.id==item.id" (click)="attachExternalBrokerPopUp(item, 2)" class="action-icon" title="Unlink agent">
                              <img src="assets/img/ic_disapprove.png" alt="img"></button>
                        </td>
                     </tr>
                     <tr *ngIf="allExtBrokers?.length==0">
                        <p class="show-not-found">No external agent found.</p>
                     </tr>
                  </table>
               </div>
            </div>
      </div>
   </div>
</div>



<div class="modal animated" id="addPropertyReason">
   <div class="modal-dialog fadeIndown">
      <div class="modal-content">
         <div class="modal-header modal-header-new">
            <h4 class="modal-title">Add Reason</h4>
            <button style="display: none;" type="button" class="close" data-dismiss="modal" #modalClose>&times;</button>
            <button type="button" class="close" (click)="closeModal()">&times;</button>
         </div>
   
         <form class="form-horizontal form-model0P form-model-newP" role="form" ngNativeValidate #addForm="ngForm" (ngSubmit)="changeStatus(item, parameter.status); addForm.reset();">
         <div class="modal-body modal-body-new">
            <div class="row">
               <div class="col-12">
               <div class="form-group-2">
                     <div class="form-group">
                     <textarea rows="4" required class="form-control note" name="reason" [(ngModel)]="reason"></textarea>
                  </div>
               </div>
               </div>
               <div class="col-12">
                  <div class="btn-cont text-right">
                     <button type="submit" [disabled]="!addForm.valid" class="btn btn-primary">Add</button>
                  </div>
               </div>
            </div>
         </div>
         </form>
      </div>
   </div>
</div>

<a style="display:none;" #rejectModalOpen data-toggle="modal" data-target="#addSellerRejectReason"></a>                           
<div class="modal animated" id="addSellerRejectReason">
   <div class="modal-dialog fadeIndown">
      <div class="modal-content">
         <div class="modal-header modal-header-new">
            <h4 class="modal-title">Add Reason for Rejection</h4>
            <button style="display: none;" type="button" class="close" data-dismiss="modal" #rejectModalClose>&times;</button>
            <button type="button" class="close" (click)="closeReasonModal()">&times;</button>
         </div>
   
         <form class="form-horizontal form-model0P form-model-newP" role="form" ngNativeValidate #addForm="ngForm" (ngSubmit)="changeStatusSellerSelection(); addForm.reset();">
         <div class="modal-body modal-body-new">
            <div class="row">
               <div class="col-12">
               <div class="form-group-2">
                     <div class="form-group">
                     <textarea rows="4" required class="form-control note" name="reason" [(ngModel)]="reason"></textarea>
                  </div>
               </div>
               </div>
               <div class="col-12">
                  <div class="btn-cont text-right">
                     <button type="submit" [disabled]="!addForm.valid" class="btn btn-primary">Add</button>
                  </div>
               </div>
            </div>
         </div>
         </form>
      </div>
   </div>
</div>