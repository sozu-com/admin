
<div class="white-bg padding15">
  <div class="row">
    <div class="col-md-6">
      <div class="title-group">
        <h5 *ngIf="!editMode"><a routerLink="/dashboard/collections/view-collections" href="javascript://"><i
              class="fa fa-angle-double-left"></i> </a> &nbsp;&nbsp;{{'addCollection.addLabel' | translate}}</h5>
        <h5 *ngIf="editMode"> <a routerLink="/dashboard/collections/view-collections" href="javascript://"><i
              class="fa fa-angle-double-left"></i> </a> &nbsp;&nbsp;{{'addCollection.editLabel' | translate}}: {{model?.name}}</h5>
      </div>
    </div>
    <div class="col-md-6 btn-cont">
      <!-- <app-add-lead *ngIf="this.parameter?.property_id && editMode"  [property_id]="parameter.property_id"></app-add-lead> -->
    </div>
  </div>
</div>

<div class="spacer10"></div>
<div class="white-bg add-property padding20">
  <div class="steps">
    <ul class="d-flex">
      <li [ngClass]="{'current': tab == 1}"><span></span><a (click)="setTab(1)">{{'addCollection.tabs.property' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 2}"><span></span><a (click)="setTab(2)">{{'addCollection.tabs.seller' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 3}"><span></span><a (click)="setTab(3)">{{'addCollection.tabs.buyer' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 4}"><span></span><a (click)="setTab(4)">{{'addCollection.tabs.deal' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 5}"><span></span><a (click)="setTab(5)">{{'addCollection.tabs.commission' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 6}"><span></span><a (click)="setTab(6)">{{'addCollection.tabs.uploadDocuments' | translate}}</a></li>
    </ul>
    <!-- <ul class="d-flex">
      <li [ngClass]="{'current': tab == 1}"><span></span><a>{{'addCollection.tabs.property' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 2}"><span></span><a>{{'addCollection.tabs.seller' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 3}"><span></span><a>{{'addCollection.tabs.buyer' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 4}"><span></span><a>{{'addCollection.tabs.deal' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 5}"><span></span><a>{{'addCollection.tabs.commission' | translate}}</a></li>
      <li [ngClass]="{'current': tab == 6}"><span></span><a>{{'addCollection.tabs.uploadDocuments' | translate}}</a></li>
    </ul> -->
  </div>
</div>

<div class="spacer10"></div>



<!-- Tag a building start -->
<div class="white-bg" *ngIf="tab==1">
  <div class="page-title">
    <h3>{{'addCollection.chooseYourProperty' | translate}}</h3>
  </div>

  <div class="padding40" *ngIf="model?.building?.id && showSearch==false">
    <div class="row">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.taggedBuildingName' | translate}}</p>
      </div>
      <div class="col-sm-3 col-lg-3 btn-cont text-right">
        <button type="button" class="btn btn-primary" (click)="showSearchBox()">{{'addCollection.change' | translate}}</button>
      </div>
    </div>
    <p><b>{{model?.building?.name}}</b></p>

    <div class="row">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.taggedTowerName' | translate}}</p>
      </div>
    </div>
    <p><b>{{model?.building_towers?.tower_name ? model?.building_towers?.tower_name : ('table.tr.td.NA' | translate)}}</b></p>

    <div class="row" *ngIf="model?.building_towers">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.taggedFloor' | translate}}</p>
      </div>
    </div>
    <p><b>
      {{model?.building_towers?.tower_name ? (model?.floor_num == 0 ? ('addCollection.groundFloor' | translate) : ('addCollection.floor' | translate) + ' ' + model?.floor_num) : 'NA'}}
    </b></p>
    
    <div class="row" *ngIf="model?.name">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.taggedApartmentName' | translate}}</p>
      </div>
    </div>
    <p><b>{{model?.name ? model?.name : ('table.tr.td.NA' | translate)}}</b></p>
  
    <div class="row">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.selectedDealType' | translate}}</p>
      </div>
    </div>
    <p><b>{{model?.availabilityStatusId == 1 ? availabilityStatus[0].name : availabilityStatus[1].name}}</b></p>
      
    <div class="row">
      <div class="col-sm-9 col-lg-9">
        <p class="p16">{{'addCollection.selectedModal' | translate}}</p>
      </div>
    </div>
    <p><b>{{model?.building_configuration?.name}}</b></p>
      
    <div class="row">
      <div class="col-md-12">
        <div class="btn-cont text-right">
          <button type="button" (click)="tab=2" class="btn btn-primary">{{'addCollection.next' | translate}}</button>
        </div>
      </div>
    </div>
  </div>

  <div class="padding40" *ngIf="showSearch">
    <h5 class="p16-two">{{'addCollection.SearchYourBuildingInOurDatabase' | translate}}</h5>
    <div class="searh d-flex">
      <input autocomplete="off" class="border-right-0" autocomplete="off" type="text" #buildingname
        (keyup.enter)="searchBuilding(buildingname.value)" name="buildingName" [(ngModel)]="buildingName">
      <button type="button" class="btn" type="button" (click)="searchBuilding(buildingname.value)">{{'addCollection.search' | translate}}</button>
    </div>
    <div class="spacer50"></div>
    <div *ngIf="buildingLoading">
      <img src="assets/img/loading_content.gif" />
    </div>
    <div *ngIf="!buildingLoading && parameter.buildingCount != 0" class="white-bg">
      <!-- ngNativeValidate  #tagABuilding="ngForm" -->
      <form  [formGroup]="addFormStep1"  (ngSubmit)="createCollection(addFormStep1.value, 1)">
        
        <!-- buildings listing -->
        <div class="row">
          <div class="col-lg-6 col-md-12 col-sm-12 col-12" 
          *ngFor="let item of searchedBuildings| paginate: { itemsPerPage: parameter.itemsPerPage, currentPage: parameter.page, totalItems: parameter.buildingCount }; let i = index">
            <app-project-block (setBuilding)="setBuildingId($event)" (buildingIndex)="getBuildingIndex($event)" [data]="item" [index]="i"></app-project-block>
          </div>
        </div>

        <div class="row" *ngIf="searchedBuildings?.length>0">
          <div class="col-lg-6 col-md-12 col-sm-12 col-12"></div>
          <div class="col-lg-6 col-md-12 col-sm-12 col-12 btn-cont text-right marginT15">
            <pagination-controls class="my-pagination" (pageChange)="getPage($event)"></pagination-controls>
          </div>
        </div>

        <!-- towers listing wrt building id -->
        <div class="row marginT20" *ngIf="building.id">
            <div class="col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="form-group-3">
              <label class="p16-two">{{'addCollection.selectTowerIn' | translate}} {{selectedBuilding?.name}} <span class="color-red">*</span></label>
              <select name="tower" *ngIf="selectedBuilding" formControlName="building_towers_id" required class="form-control" (change)="setTower($event.target.value)">
                <option value="">{{'addCollection.selectTower' | translate}}</option>
                <option *ngFor="let bt of selectedBuilding?.building_towers" [value]="bt.id">
                  {{bt.tower_name}}</option>
              </select>
            </div>
          </div>  
        </div>

        <!-- floor listing wrt tower id -->
        <div class="row marginT20" *ngIf="building.id && model.building_towers">
          <div class="col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="form-group-3">
              <label class="p16-two">{{'addCollection.selectFloorIn' | translate}} {{model.building_towers?.tower_name}} <span class="color-red">*</span></label>
              <select required class="form-control" name="floor_num" formControlName="floor_num" (change)="getProperties($event)">
                <option value="">{{'addCollection.selectFloor' | translate}}</option>
                <option *ngFor="let fa of model.building_towers?.unique_floors; let j=index" [value]="fa">
                  {{j == 0 ? ('addCollection.groundFloor' | translate): ('addCollection.floor' | translate) + ' '+fa}}</option>
              </select>
            </div>
          </div>  
        </div>

        <!-- properties listing wrt building id -->
        <div class="row marginT20" *ngIf="building.id && model.building_towers && model.floor_num">
            <div class="col-lg-6 col-md-6 col-sm-12 col-6">
            <div class="form-group form-group-3">
              <label class="p16-two">{{'addCollection.selectYourApartment' | translate}} <span class="color-red">*</span></label>

              <p-dropdown class="search-dropdown"
                [options]="properties" [style]="{'width':'100%'}" formControlName="property_id"
                [filter]="true" optionLabel="name" (onChange)="setPropertyId(property_id)">
              </p-dropdown>
             
            </div>
          </div>  
          <div class="col-lg-6 col-md-6 col-sm-12 col-6">
            <div class="form-group-3">
              <label class="p16-two">{{'addCollection.selectDealType' | translate}}<span class="color-red">*</span></label>
              <div class="clearfix"></div>
              <label class="cust-radio" *ngFor="let astatus of availabilityStatus; let a=index">
                <input type="radio" (change)="setAvailableStatus(a)" value="{{astatus.id}}"
                  [checked]="model?.availabilityStatusId == astatus.id ? 'checked' : ''" name="availabilityStatusId">
                <span class="checkmark">{{astatus.name}}</span>
              </label>      
              <div class="clearfix"></div>
            </div>
          </div>  
        </div>

        <div class="spacer15"></div>
        <div class="row" *ngIf="building.id && model.building_towers && model.floor_num">
          <div class="col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="form-group-3">
              <label class="p16-two">{{'addForm.selectModal' | translate}} <span class="color-red">*</span></label>
              <div class="clearfix"></div>
              <label class="cust-radio" *ngFor="let configuration of configurations">
                <input type="radio" required (change)="setConfiguration(configuration)"
                  value="{{configuration.id}}" [checked]="model.building_configuration_id == configuration.id ? 'checked' : ''"
                  name="configuration_id">
                <span class="checkmark">{{configuration.name ? configuration.name : configuration.config.name}}</span>
              </label>
              <div class="clearfix"></div>
            </div>
          </div>
        </div>
        <div class="spacer15"></div>
        
        <div class="row">
          <div class="col-md-12">
            <div class="btn-cont text-right">
              <button type="submit"  class="btn btn-primary">{{'addCollection.next' | translate}}</button>
            </div>
          </div>
        </div>
      </form>
    </div>

    <p *ngIf="parameter.buildingCount == 0 && showText" class="p18">
      <!-- {{'addCollection.didntFoundyourBuilding' | translate}}  -->
      <strong>
        <!-- <span (click)="showBuildingDetails(true)" class="green-color cursor-pointer">
          {{'addCollection.GenerateARequesttoAddABuildingByOurDataCollectors' | translate}}
        </span> -->
        <span class="green-color">
          {{'addCollection.buildingYouAreSearchingNotFound' | translate}}
        </span>
      </strong>
    </p>
    <div *ngIf="showBuilding" class="spacer50"></div>

    <form ngNativeValidate #buildingRequestForm="ngForm" (ngSubmit)="buildingRequest()">
      <div *ngIf="showBuilding" class="row">
        <div class="col-lg-7 col-md-12 col-sm-12 col-12">
          <div class="row">
            <div class="col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{'addCollection.nameBuilding' | translate}}</label>
                <input autocomplete="off" required class="form-control" [pattern]="constant.onlyWhiteSpaces" type="text" name="name"
                  [(ngModel)]="building.name" placeholder="{{'addForm.placeholder.nameOfBuilding' | translate}}">
              </div>
            </div>
            <div class="col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{'addCollection.whereItIsLocated' | translate}}</label>
                <input required placeholder="{{'addForm.placeholder.searchForLocation' | translate}}" autocorrect="off" autocapitalize="off"
                  spellcheck="off" type="text" class="form-control" #search (input)="loadPlaces()"
                  [formControl]="searchControl" [(ngModel)]="building.address" name="address">
              </div>
            </div>
          </div>
          <label class="label-optional">{{'addCollection.developerDetails' | translate}}</label>
          <div class="row">
            <div class="col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{'addCollection.nameOfDeveloper' | translate}}</label>
                <input autocomplete="off" class="form-control" [pattern]="constant.onlyWhiteSpaces" type="text" name="dev_name"
                  [(ngModel)]="building.dev_name">
              </div>
            </div>
            <div class="col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{'addCollection.contactNumber' | translate}}</label>
                <input minlength="8" maxlength="15" autocomplete="off" type="text" class="form-control" id="dev_phone"
                  [(ngModel)]="building.dev_phone" name="dev_phone" ng2TelInput [ng2TelInputOptions]="initialCountry"
                  (countryChange)="onCountryChange($event)" />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-12">
              <div class="form-group-3">
                <label>{{'addCollection.emailId' | translate}}</label>
                <input (keydown.space)="$event.preventDefault();" autocomplete="off" class="form-control" type="email" name="dev_email"
                  [(ngModel)]="building.dev_email">
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-5 col-md-12 col-sm-12 col-12">
          <div class="form-group-3 mark-pin-map">
            <label>{{'addCollection.markPinonMap' | translate}}</label>
          </div>
          <div>
            <agm-map [latitude]="latitude" [longitude]="longitude" [scrollwheel]="false"
              (mapClick)="placeMarker($event)" [zoom]="zoom">
              <agm-marker [latitude]="latitude" [longitude]="longitude"></agm-marker>
            </agm-map>
          </div>
        </div>
      </div>

      <div class="row" *ngIf="showBuilding">
        <div class="col-md-12">
          <div class="btn-cont text-right">
            <button type="submit" [disabled]="buildingRequestForm.invalid" class="btn btn-primary">{{'addCollection.submitRequest' | translate}}</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- Tag a building end -->


<!-- ngNativeValidate #createDraft="ngForm" -->
<form [formGroup]="addFormStep2" (ngSubmit)="createCollection(addFormStep2.value, 2)">
  <div class="white-bg" *ngIf="tab==2">
    <div class="page-title">
      <h3>{{'addCollection.chooseTheSeller' | translate}}</h3>
    </div>

    <div style="padding: 0px 40px;">
        
      <div class="form-group-3 row">
          <h5 class="col-sm-3 p16-two">{{'addCollection.chooseSellerType' | translate}}:</h5>
          <div class="col-sm-9">
              <div class="clearfix"></div>
              <label class="cust-radio">
                <input type="radio" formControlName="seller_type" (change)="setValue('seller_type', 1)" value="1" [checked]="model.seller_type == 1 ? 'checked' : ''" name="seller_type">
                <span class="checkmark">{{'addCollection.person' | translate}}</span>
              </label>
              <label class="cust-radio">
                <input type="radio" formControlName="seller_type" (change)="setValue('seller_type', 2)" value="2" [checked]="model.seller_type == 2 ? 'checked' : ''" name="seller_type">
                <span class="checkmark">{{'addCollection.legalEntity' | translate}}</span>
              </label>
              <label class="cust-radio">
                <input type="radio" formControlName="seller_type" (change)="setValue('seller_type', 3)" value="3" [checked]="model.seller_type == 3 ? 'checked' : ''" name="seller_type">
                <span class="checkmark">{{'addCollection.developer' | translate}}</span>
              </label>
              <div class="clearfix"></div>
          </div>
      </div>
    </div>

    <div class="paddingT0 padding40">

      <!-- search seller -->
        <h5 class="p16-two">{{'addCollection.SearchASellerInOurDatabase' | translate}}</h5>
        <div class="searh d-flex" (click)="getAllSellers('')">
          <input class="border-right-0" autocomplete="off" type="text" readonly name="ss">
          <button class="btn" type="button">{{'addCollection.search' | translate}}</button>
        </div>
        <div class="spacer50"></div>

        <!-- complete seller details -->
        <h5 class="p16-two">{{'addCollection.completeTheSellerInfo' | translate}}</h5>
        <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6 col-12">
            <div class="form-group-3">
              <label>{{ model.seller_type == 1 ? ('addCollection.name' | translate) : ('addCollection.commercialName' | translate)}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" minlength="1" maxlength="30" type="text" name="seller_name" class="form-control" formControlName="seller_name">
            </div>
          </div>
          <div *ngIf="model.seller_type !=1 " class="col-lg-3 col-md-6 col-sm-6 col-12">
            <div class="form-group-3">
              <label>{{ 'addCollection.legalName' | translate }}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" minlength="1" maxlength="30" type="text" name="seller_legal_name" class="form-control" formControlName="seller_legal_name">
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.phonenumber' | translate}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" minlength="8" maxlength="15" class="form-control" type="number" name="seller_phone" formControlName="seller_phone">
            </div>
          </div>
          <div *ngIf="model.seller_type !=1" class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.address' | translate}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" class="form-control" type="text" name="seller_address" formControlName="seller_address">
           </div>
          </div>
          <div *ngIf="model.seller_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.email' | translate}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" (keydown.space)="$event.preventDefault();" class="form-control" type="email" name="seller_email" formControlName="seller_email">
            </div>
          </div>
          <div *ngIf="model.seller_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.companyName' | translate}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" minlength="1" maxlength="30" class="form-control" type="text" name="seller_company_name" formControlName="seller_company_name">
            </div>
          </div>
        </div>
        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
              <label>{{'addCollection.fedralTaxPayerRegistry' | translate}}</label>
              <div class="clearfix"></div>
              <input required autocomplete="off" minlength="12" maxlength="13" class="form-control" type="text" name="seller_fed_tax" formControlName="seller_fed_tax">
            </div>
          </div>
        </div>

        <div class="spacer50"></div>
        <!-- bank account -->
        <h5 class="p16-two">{{'addCollection.bankAccount' | translate}}
          <span class="pull-right"><a class="add" (click)="addSellerBank($event)" href="javascript://">{{'addCollection.addNewBankAccount' | translate}}</a></span>
        </h5>
        <div formArrayName="collection_seller_banks">
        <ng-container *ngFor="let seller_banks of addFormStep2.get('collection_seller_banks').controls; let i=index">
            <div class="row" [formGroupName]="i">
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.bankName' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" minlength="1" maxlength="30" class="form-control" type="text" name="bank_name" formControlName="bank_name">
                </div>
              </div> 
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.accountNumber' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" class="form-control" type="number" minlength="10" maxlength="20" min="0" name="account_number" formControlName="account_number">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.clabeSwift' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" (keydown.space)="$event.preventDefault();" class="form-control" type="text" name="swift" formControlName="swift">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.currency' | translate}}</label>
                  <div class="clearfix"></div>
                  <select required name="currency_id" formControlName="currency_id" required class="form-control">
                    <option value="">{{'addCollection.currency' | translate}}</option>
                    <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
                  </select>
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.remove' | translate}}</label>
                  <div class="clearfix"></div>
                  <button type="button" (click)="removeSellerBank($event, seller_banks, i)">{{'addCollection.remove' | translate}}</button>
                </div>
              </div>
            </div>
        </ng-container>
        </div>

        <div class="spacer50"></div>
        <!-- legal Representative Info -->
        <h5 class="p16-two">{{'addCollection.legalRepresentativeInfo' | translate}}</h5>
        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
              <label>{{'addCollection.name' | translate}}</label>
              <div class="clearfix"></div>
              <input autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="seller_leg_rep_name" formControlName="seller_leg_rep_name">
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.phonenumber' | translate}}</label>
              <div class="clearfix"></div>
              <input autocomplete="off" class="form-control" minlength="8" maxlength="15" type="number" name="seller_leg_rep_phone" formControlName="seller_leg_rep_phone">
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.email' | translate}}</label>
              <div class="clearfix"></div>
              <input autocomplete="off" class="form-control" type="email" (keydown.space)="$event.preventDefault();" name="seller_leg_rep_email" formControlName="seller_leg_rep_email">
            </div>
          </div>
          <div *ngIf="model.seller_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
              <label>{{'addCollection.companyName' | translate}}</label>
              <div class="clearfix"></div>
              <input autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="seller_leg_rep_comp" formControlName="seller_leg_rep_comp">
            </div>
          </div>
        <!-- </div> -->
        <!-- <div class="row"> -->
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
              <label>{{'addCollection.fedralTaxPayerRegistry' | translate}}</label>
              <div class="clearfix"></div>
              <input autocomplete="off" class="form-control" minlength="12" maxlength="13" type="text" name="seller_leg_rep_fed_tax" formControlName="seller_leg_rep_fed_tax">
            </div>
          </div>
        </div>
        
        
        <div class="spacer50"></div>
        <!-- bank account -->
        <h5 class="p16-two">{{'addCollection.bankAccount' | translate}}
          <span class="pull-right"><a class="add" (click)="addSellerRepBank($event)" href="javascript://">{{'addCollection.addNewBankAccount' | translate}}</a></span>
        </h5>
        <div formArrayName="collection_seller_rep_banks">
        <ng-container *ngFor="let seller_rep_banks of addFormStep2.get('collection_seller_rep_banks').controls; let i=index">
            <div class="row" [formGroupName]="i">
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.bankName' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" minlength="1" maxlength="30" class="form-control" type="text" name="bank_name" formControlName="bank_name">
                </div>
              </div> 
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.accountNumber' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" class="form-control" type="number" minlength="10" maxlength="20" min="0" name="account_number" formControlName="account_number">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.clabeSwift' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" class="form-control" (keydown.space)="$event.preventDefault();" type="text" name="swift" formControlName="swift">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.currency' | translate}}</label>
                  <div class="clearfix"></div>
                  <select required name="currency_id" formControlName="currency_id" required class="form-control">
                    <option value="">{{'addCollection.currency' | translate}}</option>
                    <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
                  </select>
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.remove' | translate}}</label>
                  <div class="clearfix"></div>
                  <button type="button" (click)="removeSellerRepBank($event, seller_rep_banks, i)">{{'addCollection.remove' | translate}}</button>
                </div>
              </div>
            </div>
        </ng-container>
        </div>


      <div class="spacer15"></div>

      <div class="spacer15"></div>
      <div class="row">
        <div class="col-md-12">
          <div class="btn-cont text-right">
            <button type="button" class="btn btn-primary" (click)="setTab(1)">{{'addCollection.previous' | translate}}</button>
            <button type="submit" class="btn btn-primary marginL15">{{'addCollection.next' | translate}}</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</form>




<!-- ngNativeValidate #createDraft="ngForm" -->
<form [formGroup]="addFormStep3" (ngSubmit)="createCollection(addFormStep3.value, 3)">
    <div class="white-bg" *ngIf="tab==3">
      <div class="page-title">
        <h3>{{'addCollection.chooseTheBuyer' | translate}}</h3>
      </div>

      
      <div style="padding: 0px 40px;">      
        <div class="form-group-3 row">
            <h5 class="col-sm-3 p16-two">{{'addCollection.chooseBuyerType' | translate}}:</h5>
            <div class="col-sm-9">
                <div class="clearfix"></div>
                <label class="cust-radio">
                  <input type="radio" formControlName="buyer_type" (change)="setValue('buyer_type', 1)" value="1" [checked]="model.buyer_type == 1 ? 'checked' : ''" name="buyer_type">
                  <span class="checkmark">{{'addCollection.person' | translate}}</span>
                </label>
                <label class="cust-radio">
                  <input type="radio" formControlName="buyer_type" (change)="setValue('buyer_type', 2)" value="2" [checked]="model.buyer_type == 2 ? 'checked' : ''" name="buyer_type">
                  <span class="checkmark">{{'addCollection.legalEntity' | translate}}</span>
                </label>
                <label class="cust-radio">
                  <input type="radio" formControlName="buyer_type" (change)="setValue('buyer_type', 3)" value="3" [checked]="model.buyer_type == 3 ? 'checked' : ''" name="buyer_type">
                  <span class="checkmark">{{'addCollection.developer' | translate}}</span>
                </label>
                <div class="clearfix"></div>
            </div>
        </div>
      </div>
  

      <div class="paddingT0 padding40">
  
        <!-- search -->
          <h5 class="p16-two">{{'addCollection.SearchABuyerInOurDatabase' | translate}}</h5>
          <div class="searh d-flex" (click)="getAllSellers('')">
            <input class="border-right-0" autocomplete="off" type="text" readonly name="bb">
            <button class="btn" type="button">{{'addCollection.search' | translate}}</button>
          </div>
          <div class="spacer50"></div>
  
          <!-- complete details -->
          <h5 class="p16-two">{{'addCollection.completeTheBuyerInfo' | translate}}</h5>
          <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{ model.buyer_type == 1 ? ('addCollection.name' | translate) : ('addCollection.commercialName' | translate)}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" minlength="1" maxlength="30" type="text" name="buyer_name" class="form-control" formControlName="buyer_name">
              </div>
            </div>
            <div *ngIf="model.buyer_type !=1 " class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
                <label>{{ 'addCollection.legalName' | translate }}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" minlength="1" maxlength="30" type="text" name="buyer_legal_name" class="form-control" formControlName="buyer_legal_name">
              </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.phonenumber' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" type="number" minlength="8" maxlength="15" name="buyer_phone" formControlName="buyer_phone">
              </div>
            </div>
            <div *ngIf="model.buyer_type !=1" class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.address' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" type="text" name="buyer_address" formControlName="buyer_address">
              </div>
            </div>
            <div *ngIf="model.buyer_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.email' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" (keydown.space)="$event.preventDefault();" class="form-control" type="email" name="buyer_email" formControlName="buyer_email">
              </div>
            </div>
            <div *ngIf="model.buyer_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.companyName' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="buyer_company_name" formControlName="buyer_company_name">
              </div>
            </div>
          </div>
          <div class="row">
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                <label>{{'addCollection.fedralTaxPayerRegistry' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" minlength="12" maxlength="13" type="text" name="buyer_fed_tax" formControlName="buyer_fed_tax">
              </div>
            </div>
          </div>


          <div class="spacer50"></div>
          <!-- bank account -->
          <h5 class="p16-two">{{'addCollection.bankAccount' | translate}}
            <span class="pull-right"><a class="add" (click)="addBuyerBank($event)" href="javascript://">{{'addCollection.addNewBankAccount' | translate}}</a></span>
          </h5>
          <div formArrayName="collection_buyer_banks">
            <ng-container *ngFor="let buyer_banks of addFormStep3.get('collection_buyer_banks').controls; let i=index">
              <div class="row" [formGroupName]="i">
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.bankName' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" minlength="1" maxlength="30" class="form-control" type="text" name="bank_name" formControlName="bank_name">
                </div>
              </div> 
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.accountNumber' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" class="form-control" type="number" minlength="10" maxlength="20" min="0" name="account_number" formControlName="account_number">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.clabeSwift' | translate}}</label>
                  <div class="clearfix"></div>
                  <input required autocomplete="off" class="form-control" (keydown.space)="$event.preventDefault();" type="text" name="swift" formControlName="swift">
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.currency' | translate}}</label>
                  <div class="clearfix"></div>
                  <select required name="currency_id" formControlName="currency_id" required class="form-control">
                    <option value="">{{'addCollection.currency' | translate}}</option>
                    <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
                  </select>
                </div>
              </div>
              <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                  <label>{{'addCollection.remove' | translate}}</label>
                  <div class="clearfix"></div>
                  <button type="button" (click)="removeBuyerBank($event, buyer_banks, i)">{{'addCollection.remove' | translate}}</button>
                </div>
              </div>
            </div>
        </ng-container>
        </div>

        
          <div class="spacer50"></div>
          <!-- legal Representative Info -->
          <h5 class="p16-two">{{'addCollection.legalRepresentativeInfo' | translate}}</h5>
          <div class="row">
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                <label>{{'addCollection.name' | translate}}</label>
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="buyer_leg_rep_name" formControlName="buyer_leg_rep_name">
              </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.phonenumber' | translate}}</label>
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" type="number" minlength="8" maxlength="15" name="buyer_leg_rep_phone" formControlName="buyer_leg_rep_phone">
              </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.email' | translate}}</label>
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" (keydown.space)="$event.preventDefault();" type="email" name="buyer_leg_rep_email" formControlName="buyer_leg_rep_email">
              </div>
            </div>
            <div *ngIf="model.buyer_type==1" class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.companyName' | translate}}</label>
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="buyer_leg_rep_comp" formControlName="buyer_leg_rep_comp">
              </div>
            </div>
          <!-- </div> -->
          <!-- <div class="row"> -->
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="form-group-3">
                <label>{{'addCollection.fedralTaxPayerRegistry' | translate}}</label>
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" minlength="12" maxlength="13" type="text" name="buyer_leg_rep_fed_tax" formControlName="buyer_leg_rep_fed_tax">
              </div>
            </div>
          </div>
        
        
          <div class="spacer50"></div>
          <!-- bank account -->
          <h5 class="p16-two">{{'addCollection.bankAccount' | translate}}
            <span class="pull-right"><a class="add" (click)="addBuyerRepBank($event)" href="javascript://">{{'addCollection.addNewBankAccount' | translate}}</a></span>
          </h5>
          <div formArrayName="collection_buyer_rep_banks">
          <ng-container *ngFor="let buyer_rep_banks of addFormStep3.get('collection_buyer_rep_banks').controls; let i=index">
              <div class="row" [formGroupName]="i">
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                    <div class="form-group-3">
                    <label>{{'addCollection.bankName' | translate}}</label>
                    <div class="clearfix"></div>
                    <input required autocomplete="off" minlength="1" maxlength="30" class="form-control" type="text" name="bank_name" formControlName="bank_name">
                  </div>
                </div> 
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                    <div class="form-group-3">
                    <label>{{'addCollection.accountNumber' | translate}}</label>
                    <div class="clearfix"></div>
                    <input required autocomplete="off" class="form-control" type="number" minlength="10" maxlength="20" min="0" name="account_number" formControlName="account_number">
                  </div>
                </div>
                <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                    <div class="form-group-3">
                    <label>{{'addCollection.clabeSwift' | translate}}</label>
                    <div class="clearfix"></div>
                    <input required autocomplete="off" class="form-control" (keydown.space)="$event.preventDefault();" type="text" name="swift" formControlName="swift">
                  </div>
                </div>
                <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                    <div class="form-group-3">
                    <label>{{'addCollection.currency' | translate}}</label>
                    <div class="clearfix"></div>
                    <select required name="currency_id" formControlName="currency_id" required class="form-control">
                      <option value="">{{'addCollection.currency' | translate}}</option>
                      <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
                    </select>
                  </div>
                </div>
                <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                    <div class="form-group-3">
                    <label>{{'addCollection.remove' | translate}}</label>
                    <div class="clearfix"></div>
                    <button type="button" (click)="removeBuyerRepBank($event, buyer_rep_banks, i)">{{'addCollection.remove' | translate}}</button>
                  </div>
                </div>
              </div>
          </ng-container>
          </div>
          
          
        <div class="spacer15"></div>
  
        <div class="spacer15"></div>
        <div class="row">
          <div class="col-md-12">
            <div class="btn-cont text-right">
              <button type="button" class="btn btn-primary" (click)="setTab(2)">{{'addCollection.previous' | translate}}</button>
              <button type="submit" class="btn btn-primary marginL15">{{'addCollection.next' | translate}}</button>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </form>



<form [formGroup]="addFormStep4" (ngSubmit)="createCollection(addFormStep4.value, 4)">
  <!-- tab-4 -->
  <div class="white-bg" *ngIf="tab==4">
    <div class="page-title">
      <h3>{{'addCollection.deal' | translate}}</h3>
    </div>
    <div class="padding40">
      <h5>{{'addCollection.completeTheDealInfo' | translate}}</h5>
      <div class="row">
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.purchaseDate' | translate}}</label>
            <div class="clearfix"></div>
            <p-calendar [style]="{'width':'100%'}" utc="true" formControlName="deal_purchase_date" class="sz-calendar" [locale]="locale" showIcon="true" 
                (onSelect)="onSelect($event)"
                showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2040"></p-calendar>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.price' | translate}}</label>
            <div class="clearfix"></div>
            <input autocomplete="off" class="form-control" step="0.01" type="number" placeholder="{{'addForm.placeholder.enter' | translate}}" formControlName="deal_price" min="0"
                name="deal_price">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
            <div class="form-group-3">
            <label>{{'addCollection.currency' | translate}}</label>
            <div class="clearfix"></div>
            <select required name="currency_id" formControlName="currency_id" required class="form-control">
              <option value="">{{'addCollection.currency' | translate}}</option>
              <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
            </select>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12" title="{{'addCollection.choosePaymentType' | translate}}">
          <div class="form-group-3">
            <label>{{'addCollection.paymentChoice' | translate}}</label>
            <div class="clearfix"></div>
            <select required #selectedPaymentChoice name="paymentchoice" formControlName="paymentchoice" (change)="addPaymentChoice($event)" class="form-control">
              <!-- <option value="">Payment Choice</option> -->
              <option value="{{c.id}}" *ngFor="let c of paymentChoices">{{ c.name }}</option>
            </select>
          </div>
        </div>
      </div>

      <div class="spacer15"></div>
      <div formArrayName="payment_choices">
        <ng-container *ngFor="let payment_choice of addFormStep4.get('payment_choices').controls; let i=index">
          <label *ngIf="i==0">{{'addCollection.payments' | translate}}</label>
          <div class="row" [formGroupName]="i">
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
                <!-- <label *ngIf="i==0">Payments</label> -->
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="name" formControlName="name">
              </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
              <div class="form-group-3">
                <!-- <label *ngIf="i==0">&nbsp;</label> -->
                <div class="clearfix"></div>
                <p-calendar [style]="{'width':'100%'}" utc="true" formControlName="date" class="sz-calendar" [locale]="locale" showIcon="true" 
                  (onSelect)="onSelect($event)" 
                  showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2040"></p-calendar>
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12" title="{{'addCollection.enterPercentage' | translate}}">
              <div class="input-group form-group-3">
                  <!-- <label *ngIf="i==0">&nbsp;</label> -->
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" (input)="getAmount(i)" type="number" step="0.01" placeholder="{{'addForm.placeholder.enter' | translate}}" formControlName="percent" min="0"
                  max="100"  name="percent">
                <div class="input-group-append">
                  <span class="input-group-text" id="basic-addon1">%</span>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12" title="{{'addCollection.enterAmount' | translate}}">
              <div class="input-group form-group-3">
                  <!-- <label *ngIf="i==0">&nbsp;</label> -->
                <div class="clearfix"></div>
                <input autocomplete="off" class="form-control" (input)="getPercentage(i)" 
                  type="number" step="0.01" formControlName="amount" min="0" name="amount">
                <!-- <div class="input-group-append">
                  <span class="input-group-text" id="basic-addon1">.00</span>
                </div> -->
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                    <!-- <label *ngIf="i==0">&nbsp;</label> -->
                <div class="clearfix"></div>
                <button type="button" (click)="removePaymentChoice($event, payment_choice, i)">{{'addCollection.remove' | translate}}</button>
              </div>
            </div>
          </div>
        </ng-container>
      </div>

      <div class="spacer15"></div>
      <div class="row" *ngIf="showMonthlyInput">
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.noOfMonthlyInstallments' | translate}}</label>
            <div class="clearfix"></div>
            <!-- (input)="addMonthlyInputs($event)" -->
            <input autocomplete="off" class="form-control" type="number" placeholder="{{'addForm.placeholder.enter' | translate}}" formControlName="num_of_months" min="0"
                name="num_of_months">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.chooseMonthlyInstallmentDate' | translate}}</label>
            <div class="clearfix"></div>
            <!-- (onSelect)="addMonthlyDates($event)"  -->
              <p-calendar [style]="{'width':'100%'}" utc="true" formControlName="monthly_date" class="sz-calendar" [locale]="locale" showIcon="true" 
              (onSelect)="onSelect($event)" 
              showButtonBar="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2040"></p-calendar>
           </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.enterMonthlyAmount' | translate}}</label>
            <div class="clearfix"></div>
            <!-- (input)="addMonthlyAmounts($event)" -->
            <input autocomplete="off" class="form-control" type="number" step="0.01" placeholder="{{'addForm.placeholder.enter' | translate}}" formControlName="monthly_amount" min="0"
                name="monthly_amount">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.done' | translate}}</label>
            <div class="clearfix"></div>
            <button type="button" (click)="findMonthlyInstallments()">{{'addCollection.done' | translate}}</button>
          </div>
        </div>
      </div>
  
      <!-- <div class="row">
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.interestRate' | translate}}</label>
            <div class="clearfix"></div>
            <input autocomplete="off" class="form-control" type="number" formControlName="deal_interest_rate" min="0" max="100" name="deal_interest_rate">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <div class="form-group-3">
            <label>{{'addCollection.penalityForLatePayment' | translate}}</label>
            <div class="clearfix"></div>
            <input autocomplete="off" class="form-control" type="number" formControlName="deal_penality" min="0" name="deal_penality">
          </div>
        </div>
      </div> -->

      <div class="row">
        <div class="col-md-12">
          <div class="btn-cont text-right">
            <button type="button" class="btn btn-primary" (click)="setTab(3)">{{'addForm.previous' | translate}}</button>
            <button type="submit" class="btn btn-primary marginL15">{{'addForm.next' | translate}}</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</form>


<form [formGroup]="addFormStep5" (ngSubmit)="createCollection(addFormStep5.value, 5)">
  <!-- tab-5 -->
  <div class="white-bg" *ngIf="tab==5">
    <div class="page-title">
      <h3>{{'addCollection.commissionDetails' | translate}}</h3>
    </div>
    <div class="padding40">
      <h5 class="marginB30">{{'addCollection.completeCommissionInfo' | translate}}</h5>

      <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <label class="p16-two">{{'addCollection.sozuCommission' | translate}}</label>
          <div class="input-group form-group-3">
            <input autocomplete="off" class="form-control" type="number" (input)="getSozuAmount($event.target.value)" step="0.01" min="0" max="100" name="comm_total_commission" formControlName="comm_total_commission">
            <div class="input-group-append">
              <span class="input-group-text" id="basic-addon1">%</span>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <label class="p16-two">{{'addCollection.sozuCommissionAmount' | translate}}</label>
          <div class="form-group-3">
            <input autocomplete="off" class="form-control" type="number" step="0.01" min="0" max="100" name="comm_total_commission_amount" formControlName="comm_total_commission_amount">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6 col-12">
          <label class="p16-two">{{'addCollection.agentCommission' | translate}}</label>
          <div class="input-group form-group-3">
            <input autocomplete="off" class="form-control" type="number" step="0.01" min="0" max="100" name="comm_shared_commission" formControlName="comm_shared_commission">
            <div class="input-group-append">
              <span class="input-group-text" id="basic-addon1">%</span>
            </div>
          </div>
        </div>
      </div>

      <div formArrayName="deal_commission_agents">
        <ng-container *ngFor="let deal_commission_agent of addFormStep5.get('deal_commission_agents').controls; let i=index">
            <div class="row" [formGroupName]="i">
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                    <label>{{'addCollection.nameOfAgent' | translate}}</label>
                    <div class="form-group-3" (click)="getBothBroker('')">
                      <div class="clearfix"></div>
                      <input autocomplete="off" class="form-control" type="text" name="name" readonly formControlName="name">
                    </div>
              </div>
              <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <label>{{'addCollection.fedralTaxPayerRegistry' | translate}}</label>
                  <div class="form-group-3">
                  <div class="clearfix"></div>
                  <input autocomplete="off" class="form-control" type="text" minlength="12" maxlength="13" name="fed_tax_payer_reg" formControlName="fed_tax_payer_reg">
                </div>
              </div>
            </div>
        </ng-container>
      </div>

      
      <div class="spacer50"></div>
      <h5 class="p16-two">{{'addCollection.bankAccount' | translate}}
        <span class="pull-right"><a class="add" (click)="addAgentBank($event)" href="javascript://">{{'addCollection.addNewBankAccount' | translate}}</a></span>
      </h5>
      <div formArrayName="collection_agent_banks">
      <ng-container *ngFor="let agent_banks of addFormStep5.get('collection_agent_banks').controls; let i=index">
          <div class="row" [formGroupName]="i">
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.bankName' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" minlength="1" maxlength="30" type="text" name="bank_name" formControlName="bank_name">
              </div>
            </div> 
            <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.accountNumber' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" type="number" minlength="10" maxlength="20" min="0" name="account_number" formControlName="account_number">
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.clabeSwift' | translate}}</label>
                <div class="clearfix"></div>
                <input required autocomplete="off" class="form-control" (keydown.space)="$event.preventDefault();" type="text" name="swift" formControlName="swift">
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.currency' | translate}}</label>
                <div class="clearfix"></div>
                <select required name="currency_id" formControlName="currency_id" required class="form-control">
                  <option value="">{{'addCollection.currency' | translate}}</option>
                  <option value="{{c.id}}" *ngFor="let c of currencies">{{ c?.code }} | {{c?.currency}}</option>
                </select>
              </div>
            </div>
            <div class="col-lg-2 col-md-6 col-sm-6 col-12">
                <div class="form-group-3">
                <label>{{'addCollection.remove' | translate}}</label>
                <div class="clearfix"></div>
                <button type="button" (click)="removeAgentBank($event, agent_banks, i)">{{'addCollection.remove' | translate}}</button>
              </div>
            </div>
          </div>
      </ng-container>
      </div>
      
      
      <div class="spacer15"></div>
      <h5 class="p16-two">{{'addCollection.collectionCommission' | translate}}
      </h5>

      
      <div formArrayName="collection_commissions">
        
      <table class="table table-bordered table-striped">
          <thead>
              <tr>
                <th rowspan="2"><b>{{'addCollection.concept' | translate}}</b></th>
                <th rowspan="2"><b>{{'addCollection.establishedDate' | translate}}</b></th>
                <th rowspan="2"><b>{{'addCollection.amount' | translate}}</b></th>
                <th rowspan="2"><b>{{'addCollection.addCollectionCommission' | translate}}</b></th>
                <th colspan="2"><b>{{'addCollection.enterCollectionCommission' | translate}}</b></th>
                <th rowspan="2"><b>{{'addCollection.addPurchaseCommission' | translate}}</b></th>
                <th rowspan="2"><b>{{'addCollection.enterPCAmount' | translate}}</b></th>
              </tr>
              <tr>
                <th colspan="1"><b>{{'addCollection.percent' | translate}}</b></th>
                <th colspan="1"><b>{{'addCollection.amount' | translate}}</b></th>
              </tr>
          </thead>
          <tbody>
          
          <ng-container *ngFor="let collection_commission of addFormStep5.get('collection_commissions').controls; let i=index">
            <tr [formGroupName]="i">
              <td>{{model.collection_commissions[i]?.name}}</td>
              <td>{{model.collection_commissions[i]?.date | date:'mediumDate'}}</td>
              <td>{{model.collection_commissions[i]?.payment_amount}}</td>
              <td>
                  <input type="checkbox" class="form-control" formControlName="add_collection_commission" name="add_collection_commission">
              </td>
              <td>
               <input 
                  type="number" class="form-control" formControlName="percent" step="0.01" name="percent{{i}}" (input)="getCollAmount($event.target.value, i, model.collection_commissions[i].payment_amount)">
              </td>
              <td>
                  <input type="number" step="0.01" class="form-control" formControlName="amount" name="amount{{i}}" (input)="getCollPercentage($event.target.value, i, model.collection_commissions[i].payment_amount)">
              </td>
              <td>
                  <input type="checkbox" class="form-control" formControlName="add_purchase_commission" name="add_purchase_commission">
              </td>
              <td>
                  <input type="number" step="0.01" class="form-control" formControlName="purchase_comm_amount" name="purchase_comm_amount{{i}}">
              </td>
            </tr>
          </ng-container>
          </tbody>
        </table>
      </div>
      <div class="spacer50"></div>

      
      <div class="row">
        <div class="col-md-12">
          <div class="btn-cont text-right">
            <button type="button" class="btn btn-primary" (click)="setTab(4)">{{'addForm.previous' | translate}}</button>
            <button type="submit" class="btn btn-primary marginL15">{{'addForm.next' | translate}}</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</form>


<form ngNativeValidate #addFormStep6="ngForm" (ngSubmit)="saveCollectionFolders()">
    <!-- tab-5 -->
    <div class="white-bg" *ngIf="tab==6">
      <div class="page-title">
        <h3>{{'addCollection.tabs.uploadDocuments' | translate}}</h3>
      </div>
      <div class="padding40">
        <h5 class="marginB30">{{'addCollection.folders' | translate}}
          <span class="pull-right">
            <a href="javascript://" data-toggle="modal" data-target="#add-folder" #folderModalOpen></a>
          <a class="add" href="javascript://" (click)="openAddFolder('add', '', '')">
            {{'addCollection.addNewFolder' | translate}}</a>
          </span>
        </h5>
  
        <div class="row" >
          <ng-container *ngFor="let folder of collectionFolders; let i=index">
            <div class="col-lg-2 col-md-4 col-sm-6 col-12 folder-box" style="background-image: url('/assets/img/ic_folder.svg')">
              
              <div class="form-group-3" (click)="modelOpenFun(folder, i)">
                <p>{{folder.name}}</p>
              </div>
              <div class="folder-action-btn">
                <!-- <button class="cursor-pointer" type="button"  (click)="modelOpenFun(folder, i)"> -->
                <!-- {{'addCollection.view' | translate}} -->
                <i (click)="modelOpenFun(folder, i)" class="fa fa-folder" aria-hidden="true"></i>
              <!-- </button>
              <button class="cursor-pointer" type="button"  (click)="openAddFolder('edit', folder, i)">
                {{'addCollection.edit' | translate}} -->
                <i (click)="openAddFolder('edit', folder, i)" class="fa fa-pencil" aria-hidden="true"></i>
              <!-- </button>
              <button class="cursor-pointer" type="button"  (click)="deleteFolderPopup(folder, i)">
                {{'addCollection.delete' | translate}} -->
                <i (click)="deleteFolderPopup(folder, i)" class="fa fa-trash" aria-hidden="true"></i>
              <!-- </button> -->
              </div>
            </div>
          </ng-container>
        </div>

        <div class="spacer50"></div>
  
        <div class="row">
          <div class="col-md-12">
            <div class="btn-cont text-right">
              <button type="button" class="btn btn-primary" (click)="setTab(5)">{{'addForm.previous' | translate}}</button>
              <button type="submit" class="btn btn-primary marginL15">{{'addForm.submit' | translate}}</button>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </form>
  


<!-- Link Seller -->
<a data-toggle="modal" data-target="#link-user-model" #linkUserModal></a>
<div class="modal" id="link-user-model">
   <div class="modal-dialog ">
      <div class="modal-content notary-avail">
            <div class="modal-header popup-header">
            <h4 class="modal-title">{{tab==2 ? ('addCollection.chooseTheSeller' | translate) : ('addCollection.chooseTheBuyer' | translate)}}</h4>
            <button type="button" class="close" #closeLinkUserModal data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

              <div class="row">
                <div class="col-md-8 col-6">
                    <input autocomplete="off" style="max-width:200px" (keyup.enter)="getAllSellers(keyword)" [(ngModel)]="keyword" class="form-control" type="text" name="keyword" placeholder="{{'addForm.placeholder.search' | translate}}">
                </div>
                <div class="col-md-4 col-5 btn-cont">
                    <a class="btn btn-primary pull-right" href="javascript://" (click)="getAllSellers(keyword)">{{'table.th.search' | translate}}</a>
                </div>
              </div>
              
               <div class="spacer40"></div>
               <div class="modal-table-data" malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                  <table class="table">
                     <tr *ngFor="let item of allUsers">
                        <td>
                           <div class="n-avail-profile">
                           <img *ngIf="item?.image" onerror='src="assets/img/default_img.png"' alt="img"
                              [defaultImage]="item?.image| img:'thumb'" [lazyLoad]="item?.image">
                           <img *ngIf="!item?.image" src="assets/img/default_img.png" alt="img">
                           
                           <div class="n-avail-info">
                              <p class="p12">{{item?.name ? item?.name : item?.comm_name}}</p>
                              <p class="p10">{{'viewProperty.phone' | translate}} : {{item?.dial_code ? item?.dial_code : constant.dial_code}}-{{item?.phone}}</p>
                           </div>
                           </div>
                        </td>
                        <td>
                           <button type="button" (click)="setSeller(item)" class="action-icon"> 
                             <img src="assets/img/green-icon.png" alt="img">
                            </button>
                           <button type="button" (click)="unsetSeller(item)" class="action-icon">
                              <img src="assets/img/ic_disapprove.png" alt="img">
                            </button>
                        </td>
                     </tr>
                     <tr *ngIf="allUsers?.length==0">
                        <p class="show-not-found">
                           {{'viewProperty.noSellerHasRequestedForTheProperty' | translate}}
                        </p>
                     </tr>
                  </table>
               </div>
            </div>
      </div>
   </div>
</div>
  


<!-- Link External Broker -->
<a data-toggle="modal" data-target="#link-broker-model" #linkExtBrokerModal></a>
<div class="modal" id="link-broker-model">
   <div class="modal-dialog ">
      <div class="modal-content notary-avail">
            <div class="modal-header popup-header">
            <h4 class="modal-title">{{'viewProperty.linkAgent' | translate}}</h4>
            <button type="button" class="close" #closeExtBrokerModal data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

               <!-- <p class="modal-title" *ngIf="property?.external_broker?.id">{{'viewProperty.currentlyLinkedToAgent' | translate}} - <b>{{property?.external_broker?.name}}</b></p> -->

               <div class="row">
                  <div class="col-md-8 col-6">
                     <input style="max-width:200px" (keyup.enter)="getBothBroker(keyword)" [(ngModel)]="keyword" class="form-control" type="text" name="keyword" placeholder="{{'addForm.placeholder.search' | translate}}">
                 </div>
                 <div class="col-md-4 col-5 btn-cont">
                     <a class="btn btn-primary pull-right" href="javascript://" (click)="getBothBroker(keyword)">{{'viewProperty.search' | translate}}</a>
                 </div>
               </div>

               <div class="spacer40"></div>
               <div class="modal-table-data" malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                  <table class="table">
                     <tr *ngFor="let item of allExtBrokers">
                        <td>
                           <div class="n-avail-profile">
                           <img *ngIf="item?.image" onerror='src="assets/img/default_img.png"' alt="img"
                              [defaultImage]="item?.image| img:'thumb'" [lazyLoad]="item?.image">
                           <img *ngIf="!item?.image" src="assets/img/default_img.png" alt="img">
                           
                           <div class="n-avail-info">
                              <p class="p12">{{item?.name | titlecase}}</p>
                              <p class="p10 marginB0">{{item?.is_external_agent ? 'OUTSIDE AGENT' : 'IN-HOUSE AGENT'}}</p>
                              <p class="p10">{{'viewProperty.phone' | translate}} : {{item?.dial_code ? item?.dial_code : constant.dial_code}}-{{item?.phone}}</p>
                           </div>
                           </div>
                        </td>
                        <td>
                           <button type="button" (click)="setAgent(item)" class="action-icon" title="{{'table.title.linkAgent' | translate}}">
                              <img src="assets/img/green-icon.png" alt="img"></button>
                           
                           <button type="button" (click)="unsetAgent()" class="action-icon" title="{{'table.title.unlinkAgent' | translate}}">
                              <img src="assets/img/ic_disapprove.png" alt="img"></button>
                        </td>
                     </tr>
                     <tr *ngIf="allExtBrokers?.length==0">
                        <p class="show-not-found">{{'viewProperty.noExternalAgentFound' | translate}}</p>
                     </tr>
                  </table>
               </div>
            </div>
      </div>
   </div>
</div>



<!-- add note modal -->
<div class="modal animated" id="add-folder">
    <div class="modal-dialog fadeIndown">
      <div class="modal-content">
        <div class="modal-header modal-header-new">
            <h4 class="modal-title">{{'addCollection.folderName' | translate}}</h4>
            <button style="display: none;" type="button" class="close" data-dismiss="modal" #folderModalClose>&times;</button>
            <button type="button" class="close" (click)="closeFolderModal()">&times;</button>
        </div>
  
        <form class="form-horizontal form-model0P form-model-newP" role="form" ngNativeValidate #addForm="ngForm" (ngSubmit)="addFolder(); addForm.reset();">
          <div class="modal-body modal-body-new">
            <div class="row">
              <div class="col-12">
                <div class="form-group-2">
                    <div class="form-group">
                      <input autocomplete="off" required class="form-control note" name="folderName" [(ngModel)]="folderName">
                  </div>
                </div>
              </div>
              <div class="col-12">
                  <div class="btn-cont text-right">
                      <button *ngIf="!selectedFolder.id else UpdateNote" [disabled]="!addForm.valid" type="submit" class="btn btn-primary">{{'commonBlock.addBtn' | translate}}</button>
                      <ng-template #UpdateNote>
                          <button type="submit" [disabled]="!addForm.valid" class="btn btn-primary">{{'commonBlock.updateBtn' | translate}}</button>
                      </ng-template>
                  </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>


  <a href="javascript://" data-toggle="modal" data-target="#collection-notes" #docsModalOpen></a>
  <div class="modal animated" id="collection-notes">
        <div class="modal-dialog fadeIndown">
              <div class="modal-content notary-avail">
                    <div class="modal-header popup-header">
                          <h4>{{folderName}}</h4>
                          <button style="display: none;" type="button" class="close" data-dismiss="modal" #docsModalClose>&times;</button>
                          <button type="button" class="close" (click)="closeModal()">&times;</button>
                    </div>
  
                    <div class="modal-body">
                          <div class="white-bg">
                                <div class="row">
                                      <div class="col-8">
                                            <p class="p16 marginB0">{{'addCollection.addDocxNameAndChooseFile' | translate}}</p>
                                      </div>
                                      <div class="col-4 text-right">
                                            <a class="add" href="javascript://" (click)="addDocs()">
                                              <img *ngIf="parameter.loading" src="assets/img/loader_gif.gif" height="20">
                                              {{'commonBlock.add' | translate}}
                                            </a>
  
                                            <ng-template #noAddPermissiom>
                                                  <a class="add" href="javascript://">{{'commonBlock.add' | translate}}</a>
                                            </ng-template>
                                      </div>
                                </div>
                          </div>
                          <div class="form-group-2">
                                <div class="form-group">
                                  <input type="text" autocomplete="off" name="docsName" [(ngModel)]="docsName">
                                </div>
                          </div>
                          <div class="form-group-2">
                                <div class="form-group">
                                  <input type="file" name="docFile" #docsFile
                                  accept=".doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf,image/x-png,image/jpg,image/jpeg"
                                  (change)="onSelectFile($event.target.files)">
                                </div>
                          </div>
                          <div *ngIf="docs?.length!=0" [ngStyle]="{'max-height':sent_as === 1 ? '250px' : '' }" class="write-note white-bg"
                                malihu-scrollbar [scrollbarOptions]="scrollbarOptions">
                                <div class="wn-block" *ngFor="let item of docs; let i=index">
                                      <div class="circle">
                                            <span></span>
                                      </div>
                                      <a class="delete" href="javascript://" (click)="deleteDocsPopup(item, i)">{{'commonBlock.delete' | translate}}</a>
  
                                      <ng-template #noDeletePermissiom>
                                            <a class="delete" href="javascript://">{{'commonBlock.delete' | translate}}</a>
                                      </ng-template>
                                      <p class="time" title="'Click to view'">
                                        <a target="_blank" href="{{item.display_name}}">
                                            {{item?.name}}
                                        </a></p>
                                      <!-- <pre class="p13" *ngIf="!item.show">{{item.note.slice(0, 90)}} <span class="read-more" *ngIf="item.note.length>100" (click)="item.show=true">Read more</span></pre>
                                      <pre class="p13" *ngIf="item.show">{{item.note}}</pre> -->
                                </div>
                          </div>
                          <div *ngIf="docs?.length==0" class="write-note white-bg" [ngStyle]="{'height':sent_as === 1 ? '230px' : '245px' }">
                                <p class="show-not-found">
                                      {{'message.error.noDocumentFound' | translate}}
                                </p>
                          </div>
                    </div>
              </div>
        </div>
  </div>